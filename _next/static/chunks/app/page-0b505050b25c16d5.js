(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2418:function(e,t,n){Promise.resolve().then(n.bind(n,1397))},475:function(e,t,n){"use strict";n.r(t);var i=n(7437),s=n(2265);t.default=e=>{let{isMini:t=!1,children:n}=e,a=(0,s.useRef)(null),[o,r]=(0,s.useState)(!1),l=()=>{var e=document.createRange();e.selectNode(a.current),window.getSelection().removeAllRanges(),window.getSelection().addRange(e),document.execCommand("copy"),window.getSelection().removeAllRanges(),r(!0)};return t?(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("div",{ref:a,className:"whitespace-pre-wrap ".concat(o?"":"text-red-500"),children:n}),(0,i.jsx)("button",{className:"select-none",onClick:l,children:"Copy"})]}):(0,i.jsxs)("div",{className:"bg-white px-2 py-1 border-black border-2 rounded-xl shadow-2xl flex mt-2 mb-2",children:[(0,i.jsx)("div",{className:"whitespace-pre-wrap grow",children:(0,i.jsx)("div",{ref:a,children:n})}),(0,i.jsx)("button",{className:"px-4 py-0 rounded-lg self-start select-none",onClick:l,children:"Copy"})]})}},1397:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var i=n(7437),s=n(2265);let a={MEDIC_MAX_USAGE:2,TWOFIVE_REQUIRED_COUNT:2,CURSE_INITIAL_COOLDOWN:60,CURSE_COOLDOWN:300,MINE_INITIAL_COOLDOWN:120,MINE_COOLDOWN:180,CONTROLLER_INITIAL_COOLDOWN:120,CONTROLLER_COOLDOWN:180,SABOTAGE_INITIAL_COOLDOWN:180,SABOTAGE_COOLDOWN:180,EMERGENCY_DURATION:180,MARTIAL_COUNTDOWN_DURATION:60,MARTIAL_DURATION:60,BLOCKAGE_DURATION:180,MEETING_DISCUSS_DURATION:180,MEETING_VOTE_DURATION:120,IMPOSTER_LIST:["mine","curse","evilL","controller"],ROSTER:{8:["mine","curse","medic","speaker","l","twofive","evp","ivp"],10:["evilL","controller","mine","medic","aunt","uncle","l","evp","ivp","psychic"],11:["evilL","controller","mine","medic","aunt","uncle","l","evp","ivp","psychic","twofive"],12:["mine","controller","evilL","twofive","medic","aunt","uncle","speaker","l","evp","ivp","psychic"]},LOCATION:["Theatre (1/F)","Office外 (2/F)","2/F 205","2/F 206","The wells","Oasis"],EMERGENCY_LOCATION:["2/F 205","Theatre (1/F)","Oasis"]},o=["Ada","Gordon","Fai","Javier","Jimmy Chan","Nok","Selina","Soon","Tree","林港","啤子","薯仔"],r={medic:{type:"count",requiredCount:Math.round(a.LOCATION.length/a.MEDIC_MAX_USAGE),maxUsage:a.MEDIC_MAX_USAGE},ivp:{type:"count",requiredCount:0,maxUsage:1},evp:{type:"count",requiredCount:0,maxUsage:1},curse:{type:"cooldown",initialCooldown:a.CURSE_INITIAL_COOLDOWN,cooldown:a.CURSE_COOLDOWN},mine:{type:"cooldown",initialCooldown:a.MINE_INITIAL_COOLDOWN,cooldown:a.MINE_COOLDOWN},controller:{type:"cooldown",initialCooldown:a.CONTROLLER_INITIAL_COOLDOWN,cooldown:a.CONTROLLER_COOLDOWN},sabotage:{type:"cooldown",initialCooldown:a.SABOTAGE_INITIAL_COOLDOWN,cooldown:a.SABOTAGE_COOLDOWN},twofive:{type:"count",requiredCount:a.TWOFIVE_REQUIRED_COUNT,maxUsage:1}},l={ABILITY_COOLDOWN:"abilityCooldown",CURSE_EXECUTED:"curseExecuted",CURSE_DEATH:"curseDeath",GUESS_SUCCESS:"guessSuccess",GUESS_FAILURE:"guessFailure",VOTE_SUCCESS:"voteSuccess",VOTE_DRAW:"voteDraw",TWO_FIVE_TRANSFORMATION:"twofiveTransformation",PSYCHIC_PLAYER_DEATH:"psychicPlayerDeath",IMPOSTER_WIN:"imposterWin",CREWMATE_WIN:"crewmateWin",CREWMATE_MISSION_WIN:"crewmateMissionWin"};l.ABILITY_COOLDOWN,l.CURSE_DEATH,l.GUESS_SUCCESS,l.GUESS_FAILURE,l.VOTE_SUCCESS,l.VOTE_DRAW,l.TWO_FIVE_TRANSFORMATION,l.CREWMATE_MISSION_WIN;class c{constructor(e,{personal:t},n={}){this.type=e,this.personal=t,this.data=n,this.id=e+Date.now(),console.log(this.id)}}let d={event:{COUNTDOWN:"countdown",ENDED:"ended",SUCCESS:"success",FAILURE:"failure"},ability:{AVAILABLE:"ready",NOT_AVAILABLE:"notAvailable",MAXED:"maxed"}},h={gameStart:{roster:"歡迎來到Among us{numPlayer}人局，本次遊戲角色有： \n\nCrewmate:\n{crewmates}\n\nImposter:\n{imposters}",general:'任務：\n你可以向中央系統發送""mission""，已查看目前任務完成狀況。 \n\n發現屍體：\n當發現屍體時，可以向中央系統發送""report""。 將會立即召開一次臨時年終檢討。\n\n年終檢討：\n玩家將會有{meetingDiscussDuration}分鐘的時間作討論， 討論完畢後有{meetingVoteDuration}分鐘的時間進行投票。得票最多者會被處死，平票則無人死亡。\n年終檢討召開時，所有屍體進入亡靈狀態。\n\n遊戲規則： \n切勿與任何其他玩家私訊，中央系統通知下為例外。\n不可偷看其他玩家的手機。\n不可給其他玩家觀看你的手機。\n不可撘電梯。\n當中央系統宣佈年終檢討後，不可作出任何行動必須立刻前往{meetingLocation}。\n被殺: 屍體狀態，不可移動/說話，靜待被發現。\n屍體會在年終檢討後成為亡靈(帶上口罩)，不可說話，可自由移動並繼續完成任務，可被復活。',crewmate:"你屬於Crewmate陣型， 主要遊戲目的為找出imposter及生存。 \n\n請盡量完成任務，當所於Crewmate完成自己所有任務時，於Crewmate將勝出。",imposter:'你屬於Imposter陣營，主要任務為殺死Crewmate，及阻止Crewmate順利完成任務。\n\n當剩餘Crewmate數量少於或等於Imposter數量於，Imposter將勝出。\n\n遊戲中你可以進行Sabotage，以阻礙玩家的完成任務進程， 或限制玩家的行動。選項如下：\n\n戒嚴 - 全場玩家需於{martialCountdownDuration}分鐘內進入最近的房間\n緊急維修 - 需要於{emergencyDuration}分鐘內，進入三個不同的房間進行搶修。\n道路堵塞 - 所有樓梯封閉{blockageDuration}分鐘 \n\n請向中央系統發出訊息如：""martiallaw""，""emergencyfix""，""roadblock""\n\nSabotage冷卻為事件結束後{sabotageCooldown}分鐘。',character:"你的角色 - {characterName}，屬於{faction}陣營。\n\n{characterDescription}",ocGeneral:"[地雷師][地雷]  OC將為地雷師放置地雷，OC會殺死下一位進入該樓玩家。 \n\n被操控擊殺玩家後，向中央系統報吿\n\n格式：\n地雷（玩家名字）\n------------\n[終檢] 年終檢討開始後，請向中央系統報吿\n\n格式：\n終檢開始\n------------\n[緊急維修] 玩家及成功Flip Bottle後，請向中央系統報吿。\n\n格式：\n維修 （房間）\n------------\n[戒嚴] 驅趕玩家進入房間，若戒嚴結束時玩家未能進入房間請將其擊殺。\n\n擊殺後，請向中央系統報吿。\n格式：\n戒嚴 （玩家名字）\n------------\n[道路堵塞] 堵塞所有樓層通道\n "},character:{speaker:{name:"大聲公",shortDescription:"可以向全部人匿名傳訊",longDescription:"你可以利用中央通訊系統傳送給所有人。\n\n註：切勿直接傳送給任何玩家。\n\n以下是中央傳訊系統的Contact，他將會為你向所有玩家公佈你的訊息。"},l:{name:"L",shortDescription:"可以猜測Imposter身份，成功則擊殺Imposter",longDescription:"在中檢期間，你可以傳送給中央系統，猜測Imposter玩家的角色。若正確，該名玩家立即死亡。若錯誤，則你立即死亡。\n\n格式如下：玩家名字 角色。（e.g. Domnic 營主）"},evp:{name:"EVP",shortDescription:"可以召開年終檢討（{maxUsage}次）",longDescription:'你可以照開{maxUsage}次終檢，但你的身份將會被暴露（中央系統將會議你的名義召開該終檢）。\n\n請向中央系統發送"meeting"，以召開一次終檢。'},ivp:{name:"IVP",shortDescription:"可以召開年終檢討（{maxUsage}次）",longDescription:'你可以召開{maxUsage}次終檢。\n\n請向中央系統發送""meeting""，以召開一次終檢。'},medic:{name:"獸醫",shortDescription:"可以復活已死亡的玩家（{maxUsage}次）",longDescription:"完成固定數量（{requiredCount}）任務後， 中央系統會通知你可以啟動復活技能。\n      \n你可以給予手上的復活卡予一位處於死亡狀態的玩家（亡靈），該角色可以即時復活並繼續進行遊戲。"},mine:{name:"地雷師",shortDescription:"可以放置地雷炸死其他玩家 (冷卻：{cooldown}分鐘)",longDescription:"你可以給予手上的Token予該樓層OC，令其擊殺下一位進入該樓層的玩家（包括你及其他Imposter）。\n\n註：中央系統宣告你可使用技能後才可啟用。\n\n冷卻：\n遊戲開始/終檢後{initCooldown}分鐘。\n及觸發技能後{cooldown}分鐘。"},controller:{name:"木偶師",shortDescription:"可以操控OC殺死其他玩家 (冷卻：{cooldown}分鐘)",longDescription:"你可以給予手上的Token予該房間OC，讓OC將下一位完成房間任務的玩家擊殺（包括你及其他Imposter）。\n\n註：中央系統宣告你可使用技能後才可啟用。\n\n冷卻：\n遊戲開始/終檢後{initCooldown}分鐘。\n及觸發技能後{cooldown}分鐘。"},curse:{name:"詛咒師",shortDescription:"可以詛咒並殺死其他玩家 (冷卻：{cooldown}分鐘)",longDescription:"你可以咀咒一名玩家（身處同一房間下，拍下目標照片，後向中央系統發送照片），此玩家會在下一次年終檢討後死亡(若詛咒師未死亡) 。\n\n使用方法：\n向中央系統私訊：（玩家名字）（房間位置）   \n例：Dominic The wells\n\n註：中央系統宣告你可使用技能後才可啟用。\n\n冷卻：\n遊戲開始/終檢後{initCooldown}分鐘。\n及觸發技能後{cooldown}分鐘。"},evilL:{name:"夜神月",shortDescription:"可以猜測Crewmate身份，成功則擊殺Crewmate",longDescription:"在中檢期間，你可以傳送給中央系統，猜測Crewmate玩家的角色。若正確，該名玩家立即死亡。若錯誤，則你立即死亡。\n  \n  格式如下：玩家名字 角色。（e.g. Domnic 營主）"},twofive:{name:"二五仔",shortDescription:"一定數量Imposter死亡後將加入Imposter陣形 （{requiredCount}）",longDescription:"當第一名Imposter死亡時，你將會改變陣型，加入imposter陣營，並取代其角色，獲得他的技能。"},aunt:{name:"三姑",shortDescription:"可以與六婆私信",longDescription:'身為三姑六婆中的其中一位，你可以與另一位同伴"六婆"私訊。\n\n注意：切勿與任何其他人私訊 ！\n\n以下是這回合"六婆"的Contact。'},uncle:{name:"六婆",shortDescription:"可以與三姑私信",longDescription:'身為三姑六婆中的其中一位，你可以與另一位同伴"三姑"私訊。\n\n注意：切勿與任何其他人私訊 ！\n\n以下是這回合"三姑"的Contact。'},psychic:{name:"通靈師",shortDescription:"可以與已死亡的玩家私訊",longDescription:"當有角色死亡後，你可以獲得他們的Contact，並與他們私信。\n\n註：當你與他們私聊後，他們亦會知曉你的身份（非角色）。\n"}},ability:{medic:{use:"你已經成功復活了{player}。",ready:"復活技能已經可以使用。",notAvailable:"你還需完成{remainingCount}任務，才可使用復活技能。",token:"\n[此信息只可出示一次， 請向亡靈(非屍體)出示這個信息以使用技能。]\n\n[獸醫] 請向中央系統回報你已復活的玩家名字。\n[亡靈] 你現在即時復活\n\n格式: revive (玩家名字)\n"},curse:{use:"你已經成功詛咒了{player}。",ready:"詛咒技能已經可以使用。",notAvailable:"詛咒技能還在冷卻中，無法使用。\n      \n剩餘時間: {remainingSeconds}秒"},mine:{use:"你已經成功放置了地雷。",ready:"地雷技能已經可以使用。",notAvailable:"地雷技能還在冷卻中，無法使用。\n      \n剩餘時間: {remainingSeconds}秒",token:"\n[此信息只可出示一次， 請向OC出示這個信息以使用技能。]\n\n[地雷師] OC將為地雷師放置地雷，OC會殺死下一位進入該樓玩家。\n"},controller:{use:"你已經成功操控了OC。",ready:"操控技能已經可以使用。",notAvailable:"操控技能還在冷卻中，無法使用。\n      \n剩餘時間: {remainingSeconds}秒",token:"\n[此信息只可出示一次， 請向OC出示這個信息以使用技能。]\n\n[木偶師] OC將為木偶師放置地雷，OC會殺死下一位完成該房間任務的玩家。\n"},sabotage:{ready:"Sabotage技能已經可以使用。",notAvailable:"Sabotage技能還在冷卻中，無法使用。\n剩餘時間: {remainingSeconds}秒"},evp:{ready:"你可以召開年終檢討。",maxed:"你已經召開了年終檢討，無法再次使用。"},ivp:{ready:"你可以召開年終檢討。",maxed:"你已經召開了年終檢討，無法再次使用。"}},event:{bodyFound:{countdown:"[突發][發現屍體] 玩家發現屍體，現在召開年終檢討， 請大家立即前往陳館2/F開會。"},ivpMeeting:{countdown:"[突發][召開終檢] IVP 現在召開年終檢討， 請大家立即前往陳館2/F開會。"},evpMeeting:{countdown:"[突發][召開終檢] {evpPerson} EVP 現在召開年終檢討， 請大家立即前往陳館2/F開會。"},meetingDiscuss:{countdown:"[年終檢討] 玩家將會有{duration}秒的時間作討論，討論完畢後有兩分鐘的時間進行匿名投票。得票最多者會被處死，平票則無人死亡，可棄票。\n      \n剩餘時間: {remainingSeconds}秒",ended:"[年終檢討] 討論時間已結束，請大家立即進行投票。"},meetingVote:{countdown:"[年終檢討] 玩家將會有{duration}秒的時間進行匿名投票。得票最多者會被處死，平票則無人死亡，可棄票。\n\n剩餘時間: {remainingSeconds}秒",ended:"[年終檢討] 投票時間已結束。\n\n{voteResult}\n\n{deadList}\n\n{gameStatus}"},emergency:{countdown:"[突發][緊急維修] 陳館系統遭到嚴重破壞， 請玩家前往以下地方維修： \n\n{emergencyLocationsStatus}\n\n若在90秒內未能修理好所有房間，Crewmate將會全數死亡。\n\n剩餘時間: {remainingSeconds}秒",emergencyLocationsStatus:"{location}：{status}",success:"[緊急維修] 現時房間情況： \n\n{emergencyLocationsStatus}\n\n所有房間已經修復正常，緊急維修結束。",failure:"[緊急維修] 現時房間情況： \n\n{emergencyLocationsStatus}\n\n{duration}秒內未能修理好所有房間，Crewmate全數死亡!!!!!"},blockage:{countdown:"[突發][道路封閉] 因未知事故， 陳館所有樓梯道路封閉{duration}秒。\n\n所有樓梯將會封閉{remainingSeconds}秒",ended:"[道路封閉] 道路重啟，玩家可以重新經由樓梯前往其他樓層。"},martialCountdown:{countdown:"[突發][戒嚴] 因未知情況，系統觸發戒嚴模式。請各位玩家在60秒內進入房間。否則將會被系統殺死。\n\n剩餘時間: {remainingSeconds}秒",ended:"[戒嚴] 戒嚴結束，玩家可以重新離開房間。"},martial:{countdown:"[戒嚴] 戒嚴中。\n      \n剩餘時間: {remainingSeconds}秒",ended:"[戒嚴] 戒嚴結束，玩家可以重新離開房間。"}},notification:{[l.ABILITY_COOLDOWN]:"{ability}: {token}",[l.CURSE_EXECUTED]:"你已成功詛咒{player}，技能進入冷卻。",[l.CURSE_DEATH]:"{player}被詛咒殺死",[l.GUESS_SUCCESS]:"{player}被猜中身份，立即死亡",[l.GUESS_FAILURE]:"{player}立即死亡",[l.VOTE_SUCCESS]:"{player}被投票出局，立即死亡",[l.VOTE_DRAW]:"投票平局，無人死亡",[l.TWO_FIVE_TRANSFORMATION]:"{player}加入Imposter陣營, 取代{imposter}的角色\n-------------------\n{longDescription}\n",[l.PSYCHIC_PLAYER_DEATH]:"{player}死亡, 通靈師獲得其Contact",[l.IMPOSTER_WIN]:"剩餘Imposter數量大於或等於Crewmate數量，Imposter勝出",[l.CREWMATE_WIN]:"所有Imposter死亡，Crewmate勝出",[l.CREWMATE_MISSION_WIN]:"Crewmate完成所有任務，Crewmate勝出"},utils:{divider:"-------------------"}};var u=n(475),m=function(e,t){return e?e.replace(/{(\w*)}/g,function(e,n){return t.hasOwnProperty(n)?t[n]:""}):"Empty Template!"},v=function(e){let t=[...e],n=t.length;for(;0!=n;){let e=Math.floor(Math.random()*n);n--,[t[n],t[e]]=[t[e],t[n]]}return t};class p{setCount(e){this.count=e}resetCooldown(){this.lastUse=new Date().getTime(),this.hasNotified=!1}resetinitialCooldown(){this.isUsed=!1,this.lastUse=new Date().getTime(),this.hasNotified=!1}useAbility(){"count"===this.type?(this.count=0,this.useCount++):(this.lastUse=new Date().getTime(),this.isUsed=!0),this.hasNotified=!1}get remainingCooldown(){return(this.isUsed?this.cooldown:this.initialCooldown)-(new Date().getTime()-this.lastUse)}get remainingCount(){return this.requiredCount*(this.useCount+1)-this.count}get isAvailable(){let e=!1;if(e="count"===this.type?this.remainingCount<=0:this.remainingCooldown<=0,!this.hasNotified&&e&&("cooldown"===this.type||this.requiredCount>0)){var t;this.hasNotified=!0,this.game.notifications.push(new c(l.ABILITY_COOLDOWN,{personal:"OC"},{ability:this.name,token:null===(t=h.ability[this.name])||void 0===t?void 0:t.token}))}return e}get statusText(){var e,t,n,i,s;return"count"===this.type?this.useCount>=this.maxUsage?null===(t=h.ability[this.name])||void 0===t?void 0:t[d.ability.MAXED]:this.count>=this.requiredCount*(this.useCount+1)?null===(n=h.ability[this.name])||void 0===n?void 0:n[d.ability.AVAILABLE]:null===(e=h.ability[this.name])||void 0===e?void 0:e[d.ability.NOT_AVAILABLE]:this.isAvailable?null===(i=h.ability[this.name])||void 0===i?void 0:i[d.ability.AVAILABLE]:null===(s=h.ability[this.name])||void 0===s?void 0:s[d.ability.NOT_AVAILABLE]}constructor(e,t,{type:n,requiredCount:i,maxUsage:s,initialCooldown:a,cooldown:o}){this.game=e,this.name=t,this.type=n,this.count=0,this.requiredCount=i,this.maxUsage=s,this.useCount=0,this.initialCooldown=0,this.cooldown=0,this.isUsed=!1,this.isPaused=!1,this.isEnable=!0,this.hasNotified=!1,"count"===this.type?this.count=0:(this.initialCooldown=1e3*a,this.cooldown=1e3*o,this.lastUse=new Date().getTime())}}class g{initMission(e){this.mission=e.reduce((e,t)=>({...e,[t]:!1}),{})}get finishedMissionCount(){var e;let t=Object.values(this.mission).filter(e=>e).length;return(null===(e=this.ability)||void 0===e?void 0:e.type)==="count"&&(this.ability.count=t),t}get totalMissionCount(){return Object.values(this.mission).length}get isImposter(){return a.IMPOSTER_LIST.find(e=>e===this.name)}get alive(){return this.alive_}set alive(e){this.alive_=e,e||this.game.onCharacterDeath(this)}setMission(e,t){this.mission[e]=t,this.ability&&this.ability.setCount(this.getFinishedMissionCount())}useAbility(){this.ability&&this.ability.useAbility()}get isAbilityAvailable(){return this.ability.isAvailable}startGame(){this.ability&&this.ability.resetInitCooldown()}get nameText(){var e;return null===(e=h.character[this.name])||void 0===e?void 0:e.name}constructor(e,t,n,i){this.game=e,this.name=t,this.person=n,this.ability=i,this.mission={},this.cursed=!1,this.alive_=!0}}let C={OK:"OK",BROKEN:"BROKEN"};class x{setAllBroken(){this.locations.forEach(e=>{this.status[e]=C.BROKEN})}toggle(e){this.status[e]=this.status[e]===C.OK?C.BROKEN:C.OK}get isBroken(){return Object.values(this.status).some(e=>e===C.BROKEN)}constructor(e){this.locations=e,this.status=e.reduce((e,t)=>({...e,[t]:C.OK}),{})}}class E{start(){this.startTime=new Date().getTime()}speedUp(){this.startTime=new Date().getTime()-this.duration}get isFinished(){return new Date().getTime()-this.startTime>=this.duration}get timeLeft(){return this.duration-(new Date().getTime()-this.startTime)}get hasNextEvent(){return null!==this.nextEvent}get isFailed(){return this.emergencyHelper.isBroken}getStatusText(e){if(!this.isFinished)return e.event[this.name][d.event.COUNTDOWN];if(!this.mayFail){var t;return null!==(t=e.event[this.name][d.event.ENDED])&&void 0!==t?t:e.event[this.name][d.event.COUNTDOWN]}return this.isFailed?e.event[this.name][d.event.FAILURE]:e.event[this.name][d.event.SUCCESS]}constructor(e,{duration:t,nextEvent:n=null,isSabotage:i=!1,mayFail:s=!1,emergencyHelper:a}){this.name=e,this.startTime=0,this.duration=1e3*t,this.nextEvent=n,this.isSabotage=i,this.mayFail=s,this.emergencyHelper=a}}class O{startVoting(){this.votes={},this.aliveCharacters=this.game.characterList.filter(e=>e.alive).map(e=>e.person)}get inverse(){let e={};return Object.entries(this.votes).forEach(t=>{var n;let[i,s]=t;null!==(n=e[s])&&void 0!==n||(e[s]=[]),e[s].push(i)}),e}vote(e,t){this.votes[e]=t}tally(){let e={};return Object.values(this.votes).forEach(t=>{var n;null!==(n=e[t])&&void 0!==n||(e[t]=0),e[t]++}),e}get result(){let e=this.tally(),t=Math.max(...Object.values(e)),n=this.aliveCharacters.filter(n=>e[n]===t);return n.length>1?null:n[0]}constructor(e){this.game=e,this.aliveCharacters=[],this.votes={}}}class w{startGame(){this.initCooldown()}initCooldown(){this.sabotageAbility.resetinitialCooldown(),this.characterList.forEach(e=>{var t;null===(t=e.ability)||void 0===t||t.resetinitialCooldown()})}getCharacterByPerson(e){return this.characterList.find(t=>t.person===e)}getCharacterByCharacter(e){return this.characterList.find(t=>t.name===e)}get totalMissionCount(){let e=this.characterList.reduce((e,t)=>e+(t.isImposter?0:t.totalMissionCount),0);return e===this.finishedMissionCount&&this.notifications.push(new c(l.CREWMATE_MISSION_WIN,{personal:!1},{})),e}get finishedMissionCount(){return this.characterList.reduce((e,t)=>e+(t.isImposter?0:t.finishedMissionCount),0)}proceedEvent(){var e;this.currentEvent.isSabotage?this.sabotageAbility.resetCooldown():"meetingVote"==this.currentEvent.name&&this.initCooldown(),"meetingVote"==this.currentEvent.name&&this.processMeetingEnded(),this.currentEvent=this.events[this.currentEvent.nextEvent],null===(e=this.currentEvent)||void 0===e||e.start(),"meetingVote"==this.currentEvent.name&&this.meetingHelper.startVoting()}get isEventFinished(){var e;return null===(e=this.currentEvent)||void 0===e?void 0:e.isFinished}startBodyFound(){this.currentEvent=this.events.bodyFound,this.currentEvent.start()}startIvpMeeting(){this.currentEvent=this.events.ivpMeeting,this.currentEvent.start()}startEvpMeeting(){this.currentEvent=this.events.evpMeeting,this.currentEvent.start()}processMeetingEnded(){let e=this.meetingHelper.result;if(null!=e){let t=this.getCharacterByPerson(e);t.alive=!1,this.notifications.push(new c(l.VOTE_SUCCESS,{personal:!1},{player:t.person})),this.onCharacterDeath(t)}else this.notifications.push(new c(l.VOTE_DRAW,{personal:!1}));this.characterList.some(e=>{var t;return e.alive&&(null===(t=e.ability)||void 0===t?void 0:t.name)==="curse"})&&this.characterList.filter(e=>e.cursed).forEach(e=>{e.alive=!1,this.notifications.push(new c(l.CURSE_DEATH,{personal:!1},{player:e.person})),this.onCharacterDeath(e)})}sabotage(e){this.sabotageAbility.useAbility(),"emergency"===e&&this.emergencyHelper.setAllBroken(),this.currentEvent=this.events[e],this.currentEvent.start()}guessCorrect(e){console.log(e),this.notifications.push(new c(l.GUESS_SUCCESS,{personal:!1},{player:e.person})),e.alive=!1}guessWrong(e){this.notifications.push(new c(l.GUESS_FAILURE,{personal:!1},{player:e.person})),e.alive=!1}onCharacterDeath(e){var t,n,i,s;let o=this.characterList.filter(e=>e.alive&&e.isImposter),d=this.characterList.filter(e=>e.alive&&!e.isImposter);if(0===o.length&&this.notifications.push(new c(l.CREWMATE_WIN,{personal:!1})),d.length<=o.length&&this.notifications.push(new c(l.IMPOSTER_WIN,{personal:!1})),e.isImposter){let t=this.characterList.find(e=>"twofive"===e.name),o=this.characterList.filter(e=>!e.alive&&e.isImposter).length;t&&t.alive&&o>=a.TWOFIVE_REQUIRED_COUNT&&(t.name=e.name,t.ability=new p(this,e.name,{...r[e.name]}),this.notifications.push(new c(l.TWO_FIVE_TRANSFORMATION,{personal:!0},{player:t.person,imposter:e.nameText,longDescription:m(h.character[t.name].longDescription,{cooldown:(null===(n=t.ability)||void 0===n?void 0:n.cooldown)/60/1e3,initialCooldown:(null===(i=t.ability)||void 0===i?void 0:i.initialCooldown)/60/1e3,requiredCount:null===(s=t.ability)||void 0===s?void 0:s.requiredCount})})))}let u=null===(t=this.getCharacterByCharacter("psychic"))||void 0===t?void 0:t.alive;console.log(u),u&&this.notifications.push(new c(l.PSYCHIC_PLAYER_DEATH,{personal:!0},{player:e.person}))}clearNotification(){this.notifications=[]}get isSabotageAvailable(){return this.sabotageAbility.isAvailable}constructor(e){this.characterList=[];let t=e.length,n=a.ROSTER[t];n=v(n),e.forEach((e,t)=>{let i=n[t],s=new g(this,i,e,r[i]?new p(this,i,{...r[i]}):null);s.initMission(a.LOCATION),this.characterList.push(s)}),this.locations=a.LOCATION,this.sabotageAbility=new p(this,"sabotage",{...r.sabotage}),this.emergencyHelper=new x(a.EMERGENCY_LOCATION),this.meetingHelper=new O(this),this.currentEvent=null,this.events={bodyFound:new E("bodyFound",{duration:null,nextEvent:"meetingDiscuss"}),ivpMeeting:new E("ivpMeeting",{duration:null,nextEvent:"meetingDiscuss"}),evpMeeting:new E("evpMeeting",{duration:null,nextEvent:"meetingDiscuss"}),meetingDiscuss:new E("meetingDiscuss",{duration:a.MEETING_DISCUSS_DURATION,nextEvent:"meetingVote"}),meetingVote:new E("meetingVote",{duration:a.MEETING_VOTE_DURATION}),martialCountdown:new E("martialCountdown",{duration:a.MARTIAL_COUNTDOWN_DURATION,nextEvent:"martial"}),martial:new E("martial",{duration:a.MARTIAL_DURATION,isSabotage:!0}),emergency:new E("emergency",{duration:a.EMERGENCY_DURATION,isSabotage:!0,mayFail:!0,emergencyHelper:this.emergencyHelper}),blockage:new E("blockage",{duration:a.BLOCKAGE_DURATION,isSabotage:!0})},this.notifications=[]}}var b=e=>{var t,n,a;let{game:r}=e;r.characterList.length;let[l,c]=(0,s.useState)(null),[d,v]=(0,s.useState)(!1),p=r.characterList.filter(e=>!e.isImposter),g=r.characterList.filter(e=>e.isImposter),C=r.getCharacterByPerson(l),x=null==C?void 0:C.isImposter;return(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{className:"p-2 m-2 bg-white",onClick:()=>v(!d),children:"Show Info"}),o.map((e,t)=>(0,i.jsx)("button",{className:"p-2 m-2 bg-white",onClick:()=>c(e),children:e})),(0,i.jsx)(u.default,{children:(0,i.jsx)("div",{className:"bg-white p-4",children:(0,i.jsxs)("div",{className:"whitespace-pre",children:[(0,i.jsx)("div",{children:(0,i.jsx)("p",{children:m(h.gameStart.roster,{crewmates:p.map(e=>{var t,n,i,s,a,o;return"".concat(null===(t=h.character[e.name])||void 0===t?void 0:t.name," - ").concat(m(null===(n=h.character[e.name])||void 0===n?void 0:n.shortDescription,{cooldown:(null===(i=e.ability)||void 0===i?void 0:i.cooldown)/60/1e3,initialCooldown:(null===(s=e.ability)||void 0===s?void 0:s.initialCooldown)/60/1e3,requiredCount:null===(a=e.ability)||void 0===a?void 0:a.requiredCount,maxUsage:null===(o=e.ability)||void 0===o?void 0:o.maxUsage}))}).join("\n"),imposters:g.map(e=>{var t,n,i,s,a;return"".concat(null===(t=h.character[e.name])||void 0===t?void 0:t.name," - ").concat(m(null===(n=h.character[e.name])||void 0===n?void 0:n.shortDescription,{cooldown:(null===(i=e.ability)||void 0===i?void 0:i.cooldown)/60/1e3,initialCooldown:(null===(s=e.ability)||void 0===s?void 0:s.initialCooldown)/60/1e3,requiredCount:null===(a=e.ability)||void 0===a?void 0:a.requiredCount}))}).join("\n")})})}),"-------------------",(0,i.jsx)("div",{children:m(h.gameStart.general,{meetingDiscussDuration:r.events.meetingDiscuss.duration/60/1e3,meetingVoteDuration:r.events.meetingVote.duration/60/1e3})}),"-------------------",(0,i.jsx)("div",{children:x?m(h.gameStart.imposter,{martialCountdownDuration:r.events.martialCountdown.duration/60/1e3,emergencyDuration:r.events.emergency.duration/60/1e3,blockageDuration:r.events.blockage.duration/60/1e3}):h.gameStart.crewmate}),"-------------------",l&&(0,i.jsx)("div",{children:m(h.gameStart.character,{characterName:h.character[C.name].name,faction:x?"Imposter":"Crewmate",characterDescription:m(h.character[C.name].longDescription,{cooldown:(null===(t=r.getCharacterByPerson(l).ability)||void 0===t?void 0:t.cooldown)/60/1e3,initialCooldown:(null===(n=r.getCharacterByPerson(l).ability)||void 0===n?void 0:n.initialCooldown)/60/1e3,requiredCount:null===(a=r.getCharacterByPerson(l).ability)||void 0===a?void 0:a.requiredCount})})}),"-------------------",x&&(0,i.jsxs)("div",{children:["你的 Imposter 伙伴：",g.map(e=>(0,i.jsxs)("div",{children:[e.person," - ",h.character[e.name].name]},e.name)),"-------------------"]}),l&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:[l,"'s 任務"]}),(0,i.jsx)("p",{children:Object.entries(C.mission).map(e=>{let[t,n]=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{children:[t," - ",n?"巳完成":"未完成"]},t),(0,i.jsx)("br",{})]})})})]})]})})})]})};let y=e=>{let{character:t,ability:n}=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[t.person," (",t.name,")",(0,i.jsx)("button",{className:"ml-4",onClick:()=>n.useAbility(),children:"Use"})]}),(0,i.jsx)(u.default,{children:(0,i.jsx)("p",{children:m(t.ability.statusText,{remainingCount:n.requiredCount-n.count})})})]})},N=e=>{let{character:t,ability:n}=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[t.person," (",t.name,")",(0,i.jsx)("button",{className:"ml-4",onClick:()=>n.useAbility(),children:"Use"})]}),(0,i.jsx)(u.default,{children:(0,i.jsx)("p",{children:m(t.ability.statusText,{remainingSeconds:Math.round(t.ability.remainingCooldown/1e3)})})})]})};var I=e=>{let{game:t}=e,n=t.characterList.filter(e=>e.ability);return(0,i.jsx)("div",{children:n.map(e=>(0,i.jsx)("div",{children:"count"===e.ability.type?(0,i.jsx)(y,{character:e,ability:e.ability}):(0,i.jsx)(N,{character:e,ability:e.ability})},e.person))})},S=e=>{let{game:t}=e;return(0,i.jsx)("div",{children:(0,i.jsxs)(u.default,{children:[(0,i.jsx)("p",{children:"角色狀態"}),(0,i.jsx)("div",{children:t.characterList.map(e=>(0,i.jsxs)("div",{className:"flex justify-between pr-4",children:[(0,i.jsxs)("span",{children:[e.person," -",e.alive?(0,i.jsx)("span",{className:"text-green-600",children:"生還"}):(0,i.jsx)("span",{className:"text-red-600",children:"死亡"}),(0,i.jsxs)("span",{className:"select-none",children:[" (",e.nameText,")"]}),e.cursed?"  (被詛咒)":""]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{className:"select-none ml-4",onClick:()=>{e.alive=!e.alive},children:"Toggle"}),(0,i.jsx)("button",{className:"select-none ml-4",onClick:()=>{e.cursed=!e.cursed,t.notifications.push(new c(l.CURSE_EXECUTED,{personal:!0},{player:e.person}))},children:"Curse"}),(0,i.jsxs)("span",{className:"select-nono ml-4",children:["Guess",(0,i.jsx)("button",{onClick:()=>{t.guessCorrect(e)},children:"v"}),(0,i.jsx)("button",{onClick:()=>{t.guessWrong(e)},children:"x"})]})]})]},e.person))})]})})},j=e=>{let{game:t}=e,n=t.currentEvent;return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"text-2xl",children:["Current Event -\xa0",n?n.name:"None","\xa0"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{className:"px-4 ",disabled:null==n,onClick:()=>{var e;return null===(e=t.currentEvent)||void 0===e?void 0:e.speedUp()},children:"Speed Up"}),(0,i.jsx)("button",{className:"px-4 ",onClick:()=>t.proceedEvent(),children:"Proceed"})]})]}),n&&(0,i.jsx)(u.default,{children:m(n.getStatusText(h),{duration:n.duration/1e3,remainingSeconds:Math.round(n.timeLeft/1e3),emergencyLocationsStatus:"emergency"===n.name&&t.emergencyHelper.locations.map(e=>m(h.event.emergency.emergencyLocationsStatus,{location:e,status:t.emergencyHelper.status[e]})).join("\n")})})]})}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-2xl",children:"Meetings"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{className:"px-4 ",onClick:()=>t.startBodyFound(),children:"Body Found"}),(0,i.jsx)("button",{className:"px-4 ",onClick:()=>t.startIvpMeeting(),children:"IVP Meeting"}),(0,i.jsx)("button",{className:"px-4 ",onClick:()=>t.startEvpMeeting(),children:"EVP Meeting"})]})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("div",{className:"text-2xl",children:"Sabotage"}),(0,i.jsx)("div",{children:(0,i.jsx)(u.default,{children:m(t.sabotageAbility.statusText,{remainingSeconds:Math.round(t.sabotageAbility.remainingCooldown/1e3)})})}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{className:"px-4",onClick:()=>t.sabotage("blockage"),children:"Blockage"}),(0,i.jsx)("button",{className:"px-4",onClick:()=>t.sabotage("martialCountdown"),children:"Martial"}),(0,i.jsx)("button",{className:"px-4",onClick:()=>t.sabotage("emergency"),children:"Emergency"}),t.emergencyHelper.locations.map(e=>(0,i.jsx)("button",{disabled:(null==n?void 0:n.name)!=="emergency",onClick:()=>t.emergencyHelper.toggle(e),children:e},e))]})]})]})]})};let{default:T}=n(475);var A=e=>{var t;let{game:n}=e,a=n.meetingHelper,[o,r]=(0,s.useState)(!1);return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"mt-2 p-2",children:[(0,i.jsx)("div",{className:"text-2xl",children:"投票"}),(0,i.jsx)("div",{children:a.aliveCharacters.map(e=>(0,i.jsxs)("div",{children:[e,":",(0,i.jsx)("div",{children:a.aliveCharacters.map(t=>(0,i.jsx)("button",{className:"select-none ".concat(a.votes[e]===t?"bg-gray-500":""),onClick:()=>{a.votes[e]===t?delete a.votes[e]:a.vote(e,t)},children:t},t))})]},e))})]}),(0,i.jsxs)(T,{children:[o?Object.entries(a.inverse).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{children:[t," - ",n.join(", ")]},t)}):Object.entries(a.tally()).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{children:[t," - ",n]},t)}),"Result: ",null!==(t=a.result)&&void 0!==t?t:"No Result"]}),(0,i.jsx)("button",{onClick:()=>r(e=>!e),children:"Show Voter"})]})},D=e=>{let{game:t}=e,[n,a]=(0,s.useState)(null);return(0,i.jsxs)("div",{children:[(0,i.jsxs)(u.default,{children:["Crewmate 任務進度：",t.finishedMissionCount," /"," ",t.totalMissionCount]}),(0,i.jsx)("div",{className:"grid grid-cols-4",children:t.characterList.map(e=>(0,i.jsxs)("button",{className:"bg-white",onClick:()=>a(e),children:[e.person," (",e.nameText,")"]},e.person))}),n&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(u.default,{children:[(0,i.jsxs)("p",{children:[n.person," 's 任務"]}),(0,i.jsx)("p",{children:Object.keys(n.mission).map(e=>(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[e," -"," ",n.mission[e]?"巳完成":"未完成"]}),(0,i.jsx)("button",{className:"ml-6 select-none",onClick:()=>{n.mission[e]=!n.mission[e]},children:"Toggle"}),(0,i.jsx)("br",{})]},e))})]})})]})},_=e=>{let{game:t}=e,n=t.notifications.toReversed();return(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsxs)("div",{className:"text-2xl flex justify-between",children:[(0,i.jsx)("div",{children:"Notifications"}),(0,i.jsx)("button",{className:"text-lg",onClick:()=>{t.clearNotification()},children:"Clear"})]}),(0,i.jsx)("div",{className:"bg-white border-2 border-black rounded-xl px-2 py-1 h-[300px] overflow-y-scroll",children:n.map(e=>(0,i.jsx)("div",{children:(0,i.jsx)(u.default,{isMini:!0,className:"whitespace-pre-wrap",children:m(h.notification[e.type],e.data)})},e.id))})]})},f=e=>{let{game:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("div",{className:"grow-1 basis-0 grow",children:[(0,i.jsx)(D,{game:t}),(0,i.jsx)(S,{game:t}),(0,i.jsx)(A,{game:t})]}),(0,i.jsxs)("div",{className:"grow-1 basis-0 grow",children:[(0,i.jsx)(_,{game:t}),(0,i.jsx)(j,{game:t}),(0,i.jsx)(I,{game:t})]})]})})},L=()=>(0,i.jsx)(u.default,{children:"[房間][木偶] 接收Token後，OC會殺死下一位**完成房間任務**的玩家。 \n\n擊殺玩家後，向中央系統報吿\n\n格式：\ncontroll kill （玩家名字）\n------------\n[房間][任務] 玩家完成任務後，向中央系統報吿\n\n格式：\n（玩家名字）（房間）\n------------\n[樓層][地雷] 接收Token後，OC會殺死下一位**進入樓層**的玩家。 \n\n擊殺玩家後，向中央系統報吿\n\n格式：\nmine kill （玩家名字）\n------------\n[緊急維修] 玩家及成功維修後，請向中央系統報吿。\n\n格式：\nfix （房間）\n------------\n[戒嚴] 驅趕玩家進入房間，若戒嚴結束時玩家未能進入房間請將其擊殺。\n\n擊殺後，請向中央系統報吿。\n格式：\nkill （玩家名字）\n------------\n[道路堵塞] 堵塞所有樓層通道"});function R(){let e=(0,s.useRef)(new w(o)).current,t=(0,s.useReducer)(e=>e+1,0)[1];(0,s.useEffect)(()=>{console.log(e);let n=setInterval(()=>{t()},200);return()=>clearInterval(n)},[t]);let[n,a]=(0,s.useState)(0);return(0,i.jsxs)("main",{className:"p-8",children:[(0,i.jsx)("button",{className:"bg-white p-5",onClick:()=>e.startGame(),children:"Start Game Time"}),(0,i.jsx)("div",{className:"p-4"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{className:"p-2 m-2 bg-white",onClick:()=>a(0),children:"Start Infos"}),(0,i.jsx)("button",{className:"p-2 m-2 bg-white",onClick:()=>a(1),children:"Events"}),(0,i.jsx)("button",{className:"p-2 m-2 bg-white",onClick:()=>a(2),children:"OCs"})]}),0===n&&(0,i.jsx)(b,{game:e}),1===n&&(0,i.jsx)(f,{game:e}),2===n&&(0,i.jsx)(L,{})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2418)}),_N_E=e.O()}]);